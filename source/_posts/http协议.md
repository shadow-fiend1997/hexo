---
title: http协议
date: 2020-10-5 19:11:25
tags:
---
1.  HTTP 协议是无状态协议
   - HTTP协议自身不对请求和响应之间的通信状态进行保存，对于发送过的请求或响应都不做持久化处理。
   - 但是，为了实现期望的保持状态功能，于是引入了Cookie技术，接口请求的时候，会自动带上Cookie
   
2. 持久连接-节省通信量
   - HTTP 协议，初始版本的时候，每一次HTTP请求的时候，都会进行TCP的三次握手和四次挥手。随着传送的信息量的越来越大，这种方式很影响通信情况
   - HTTP/1.0 （部分） 和 HTTP/1.1 提出了持久连接，成为HTTP keep-alive  只要任意一端没有明确的提出断开连接的要求，则保持TCP的连接状态
   
3. 管线化
   
   - 持久连接使得多数的请求一管线化方式发送成为可能，从前发送请求之后，必须等前面一个请求响应了，才能做下一个请求的发送。也就是无法并发请求
   
4.  HTTP的缺点

    - 通信使用明文（不加密），内容可能会被窃听
    - 不验证通信方的身份，因此有可能，遭遇伪装
    - 无法证明报文的完整性，所以有可能已遭篡改

5.  HTTPS

    - 通过和SSL（Secure Socket Layer，安全套接层）或TLS（Transport  Layer Security, 安全层传输协议）组合使用，加密HTTP的通信内容

    - 提供证书验证，由第三方机构颁发，用以证明服务器和客户端是实际存在的

    - 一般HTTP 直接与TCP进行通信，HTTPS 中间加了一层，HTTP和SSL 通信，SSL和TCP进行通信

      
 6. HTTP2
   - 头部压缩
 首先是在服务器和客户端之间建立哈希表，将用到的字段存放在这张表中，那么在传输的时候对于之前出现过的值，只需要把索引(比如0，1，2，...)传给对方即可，对方拿到索引查表就行了。这种传索引的方式，可以说让请求头字段得到极大程度的精简和复用。
   - 二进制分帧 
HTTP/2 认为明文传输对机器而言太麻烦了，不方便计算机的解析，因为对于文本而言会有多义性的字符，比如回车换行到底是内容还是分隔符，在内部需要用到状态机去识别，效率比较低。于是 HTTP/2 干脆把报文全部换成二进制格式，全部传输01串，方便了机器的解析。
  - 多路复用
通信双方都可以给对方发送二进制帧，这种二进制帧的双向传输的序列，也叫做流(Stream)。HTTP/2 用流来在一个 TCP 连接上来进行多个数据帧的通信，这就是多路复用的概念。
   - 服务器推送
。在 HTTP/2 当中，服务器已经不再是完全被动地接收请求，响应请求，它也能新建 stream 来给客户端发送消息，当 TCP 连接建立之后，比如浏览器请求一个 HTML 文件，服务器就可以在返回 HTML 的基础上，将 HTML 中引用到的其他资源文件一起返回给客户端，减少客户端的等待。


遇到一个有意思的问题，http2 在什么情况下比http1.1慢？
   
   查阅资料后，个人理解是 在遇到网络较弱的时候**丢包率**大大提升，而http2是只有一个tcp连接，并且需要按照顺序传输文件，所以一旦发生丢包，必须等后面排队的文件传输完成之后才能传输这些丢包的数据。 

7. HTTP3
  http3使用的不是tcp协议，因为tcp协议自带的一些通病没法改动，所以http3绕开了tcp协议，使用了QUIC协议

 QUIC协议
- 基于UDP的传输层协议：它使用UDP端口号来识别指定机器上的特定服务器。
- 可靠性：虽然UDP是不可靠传输协议，但是QUIC在UDP的基础上做了些改造，使得他提供了和TCP类似的可靠性。它提供了数据包重传、拥塞控制、调整传输节奏以及其他一些TCP中存在的特性。
- 实现了无序、并发字节流：QUIC的单个数据流可以保证有序交付，但多个数据流之间可能乱序，这意味着单个数据流的传输是按序的，但是多个数据流中接收方收到的顺序可能与发送方的发送顺序不同！
- 快速握手：QUIC提供0-RTT和1-RTT的连接建立
- 使用TLS 1.3传输层安全协议：与更早的TLS版本相比，TLS 1.3有着很多优点，但使用它的最主要原因是其握手所花费的往返次数更低，从而能降低协议的延迟。




